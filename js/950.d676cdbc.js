"use strict";(self["webpackChunkvue_event"]=self["webpackChunkvue_event"]||[]).push([[950],{4950:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix header-box",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("文章列表")])]),t("div",{staticClass:"search-box"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[t("el-form-item",{attrs:{label:"文章分类"}},[t("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.formInline.cate_id,callback:function(t){e.$set(e.formInline,"cate_id",t)},expression:"formInline.cate_id"}},e._l(e.cateList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.cate_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"发布状态"}},[t("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.formInline.state,callback:function(t){e.$set(e.formInline,"state",t)},expression:"formInline.state"}},[t("el-option",{attrs:{label:"已发布",value:"已发布"}}),t("el-option",{attrs:{label:"未发布",value:"草稿"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.choseFn}},[e._v("查询")]),t("el-button",{on:{click:e.resetFn}},[e._v("重置")])],1)],1),t("el-button",{staticClass:"btn-pub",attrs:{type:"primary",size:"small"},on:{click:e.showPubDialogFn}},[e._v("发表文章")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.artList,border:""}},[t("el-table-column",{attrs:{label:"文章标题",prop:"title",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-link",{attrs:{underline:!1},on:{click:function(t){return e.showDetailFn(i.id)}}},[e._v(e._s(i.title))])]}}])}),t("el-table-column",{attrs:{label:"分类",prop:"cate_name",align:"center"}}),t("el-table-column",{attrs:{label:"发表时间",prop:"pub_date",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.$formDate(i.row.pub_date)))])]}}])}),t("el-table-column",{attrs:{label:"状态",prop:"state",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("div",{staticClass:"btnright"},[t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.showDetailFn(i.id)}}},[e._v("详情")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.removeFn(i.id)}}},[e._v("删除")])],1)]}}])})],1),t("el-pagination",{attrs:{"popper-append-to-body":!1,"current-page":e.formInline.pagenum,"page-sizes":[10,15,20,25],"page-size":e.formInline.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChangeFn,"current-change":e.handleCurrentChangeFn,"update:currentPage":function(t){return e.$set(e.formInline,"pagenum",t)},"update:current-page":function(t){return e.$set(e.formInline,"pagenum",t)},"update:pageSize":function(t){return e.$set(e.formInline,"pagesize",t)},"update:page-size":function(t){return e.$set(e.formInline,"pagesize",t)}}})],1),t("el-dialog",{attrs:{title:"发表文章",visible:e.dialogFormVisible,width:"35%",top:"180px",fullscreen:"","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.dialogCloseFn}},[t("el-form",{ref:"pubFormRef",attrs:{model:e.pubForm,rules:e.pubFormRules,"label-width":"80px"}},[t("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"文章标题",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.pubForm.title,callback:function(t){e.$set(e.pubForm,"title",t)},expression:"pubForm.title"}})],1),t("el-form-item",{attrs:{label:"文章分类",prop:"cate_id",placeholder:"请选择分类"}},[t("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.pubForm.cate_id,callback:function(t){e.$set(e.pubForm,"cate_id",t)},expression:"pubForm.cate_id"}},e._l(e.cateList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.cate_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"文章内容",prop:"content"}},[t("quill-editor",{on:{change:e.contentChangeFn},model:{value:e.pubForm.content,callback:function(t){e.$set(e.pubForm,"content",t)},expression:"pubForm.content"}})],1),t("el-form-item",{attrs:{label:"文章封面",prop:"cover_img"}},[t("img",{ref:"imgRef",staticClass:"cover-img",attrs:{src:i(2921),alt:""}}),t("br"),t("input",{ref:"iptFileRef",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onCoverChangeFn}}),t("el-button",{attrs:{type:"text"},on:{click:e.selCoverFn},model:{value:e.pubForm.cover_img,callback:function(t){e.$set(e.pubForm,"cover_img",t)},expression:"pubForm.cover_img"}},[e._v("+ 选择封面")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.pubArticleFn("已发布")}}},[e._v("发布")]),t("el-button",{attrs:{type:"info"},on:{click:function(t){return e.pubArticleFn("草稿")}}},[e._v("存为草稿")])],1)],1)],1),t("el-dialog",{attrs:{title:"文章预览",visible:e.detailVisible,width:"60%"},on:{"update:visible":function(t){e.detailVisible=t}}},[t("h1",{staticClass:"title"},[e._v(e._s(e.artDetail.title))]),t("div",{staticClass:"info"},[t("span",[e._v("作者："+e._s(e.artDetail.nickname||e.artDetail.username))]),t("span",[e._v("发布时间："+e._s(e.$formDate(e.artDetail.pub_date)))]),t("span",[e._v("所属分类："+e._s(e.artDetail.cate_name))]),t("span",[e._v("状态："+e._s(e.artDetail.state))])]),t("el-divider"),e.artDetail.cover_img?t("img",{attrs:{src:e.baseURL+e.artDetail.cover_img,alt:""}}):e._e(),t("div",{staticClass:"detail-box",domProps:{innerHTML:e._s(e.artDetail.content)}})],1)],1)},n=[],s=i(7877),r=i(2921),l=i(6361),o={name:"my-artList",data(){return{formInline:{pagenum:1,pagesize:10,cate_id:"",state:""},pubForm:{title:"",cate_id:"",content:"",cover_img:null,state:""},dialogFormVisible:!1,pubFormRules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:1,max:30,message:"文章标题的长度为1-30个字符",trigger:"blur"}],cate_id:[{required:!0,message:"请选择文章标题",trigger:"change"}],content:[{required:!0,message:"请输入文章内容",trigger:"change"}],cover_img:[{required:!0,message:"请上传文章封面",trigger:"change"}]},cateList:[],contentChang:!1,artList:[],total:0,detailVisible:!1,artDetail:{},baseURL:l.v}},methods:{showPubDialogFn(){this.contentChang=!1,this.dialogFormVisible=!0},handleClose(e){this.$confirm("此操作将导致文章信息丢失, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e(),this.contentChang=!0})).catch((e=>e))},async getCateListFn(){const{data:e}=await(0,s.I2)();this.cateList=e.data},selCoverFn(){this.$refs.iptFileRef.click()},onCoverChangeFn(e){const t=e.target.files;if(0===t.length)this.pubForm.cover_img=null,this.$refs.imgRef.setAttribute("src",r);else{this.pubForm.cover_img=t[0];const e=URL.createObjectURL(t[0]);this.$refs.imgRef.setAttribute("src",e)}this.$refs.pubFormRef.validateField("cover_img")},pubArticleFn(e){this.pubForm.state=e,this.$refs.pubFormRef.validate((async e=>{if(!e)return!1;{const e=new FormData;e.append("title",this.pubForm.title),e.append("cate_id",this.pubForm.cate_id),e.append("content",this.pubForm.content),e.append("cover_img",this.pubForm.cover_img),e.append("state",this.pubForm.state);const{data:t}=await(0,s.Eg)(e);if(0!==t.code)return this.$message.error({message:`${t.message}`,duration:2e3,customClass:"windthClass"});this.$message.success({message:`${t.message}`,duration:2e3,customClass:"windthClass"}),this.dialogFormVisible=!1,this.getArticleListFn()}}))},contentChangeFn(){this.contentChang||this.$refs.pubFormRef.validateField("content")},dialogCloseFn(){this.$refs.pubFormRef.resetFields(),this.$refs.imgRef.setAttribute("src",r)},async getArticleListFn(){const{data:e}=await(0,s.Us)(this.formInline);this.artList=e.data.reverse(),this.total=e.total},handleSizeChangeFn(e){this.formInline.pagesize=e,this.formInline.pagenum=1,this.getArticleListFn()},handleCurrentChangeFn(e){this.formInline.pagenum=e,this.getArticleListFn()},choseFn(){this.formInline.pagenum=1,this.formInline.pagesize=10,this.getArticleListFn()},resetFn(){this.formInline.pagenum=1,this.formInline.pagesize=10,this.formInline.cate_id="",this.formInline.state="",this.getArticleListFn()},async showDetailFn(e){this.detailVisible=!0;const{data:t}=await(0,s.f$)(e);this.artDetail=t.data},removeFn(e){this.$confirm("是否删除该文章?","删除文章",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const{data:t}=await(0,s.VT)(e);if(0!==t.code)return this.$message.error({message:`${t.message}`,duration:2e3,customClass:"windthClass"});this.$message.success({message:`${t.message}`,duration:2e3,customClass:"windthClass"}),1===this.artList.length&&this.formInline.pagenum>1&&this.formInline.pagenum--,this.getArticleListFn()})).catch((()=>{this.$message({type:"warning",message:"已取消删除",duration:2e3,customClass:"windthClass"})}))}},created(){this.getCateListFn(),this.getArticleListFn()}},c=o,u=i(1001),m=(0,u.Z)(c,a,n,!1,null,"7948ffd7",null),p=m.exports},2921:function(e,t,i){e.exports=i.p+"img/cover.54bfb07c.jpg"}}]);
//# sourceMappingURL=950.d676cdbc.js.map